Sub stocks():    'Variable delcarations    Dim currStock As String    Dim nextStock As String    Dim totalVolume As LongLong    Dim summTableRow As Integer    Dim openPrice As Double    Dim closePrice As Double    Dim yearlyChange As Double    Dim percentChange As Double    Dim lastRow As Double    Dim ws As Worksheet    Dim summTableRow2 As Integer    Dim row_max As Integer    Dim max_change As Double    Dim min_change As Double    Dim row_min As Integer    Dim row_totalVolume As Integer    Dim totalVolume2 As LongLong    'Loopin through worksheets For Each ws In Worksheets        'Variable assignments        totalVolume = 0        summTableRow = 2        lastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row        openPrice = ws.Cells(2, 3).Value                       'Loopin        For i = 2 To lastRow            'Pull curr stock, next cc, current total volume, yearly change, and percent change                currStock = ws.Cells(i, 1).Value                nextStock = ws.Cells(i + 1, 1).Value                totalVolume = ws.Cells(i, 7).Value + totalVolume                ws.Cells(1, 9).Value = "Ticker"                ws.Cells(1, 10).Value = "Yearly Change"                ws.Cells(1, 11).Value = "Percent Change"                ws.Cells(1, 12).Value = "Total Stock Volume"                                'if next stock is different                If currStock <> nextStock Then                'Grab the closing price                closePrice = ws.Cells(i, 6).Value                yearlyChange = closePrice - openPrice                                            'deal with divide by 0                    If openPrice = 0 Then                      percentChange = 0                    Else:                        percentChange = (yearlyChange / openPrice)                    End If                                        'write to summary table                    ws.Cells(summTableRow, 9).Value = currStock                    ws.Cells(summTableRow, 12).Value = totalVolume                    ws.Cells(summTableRow, 10).Value = yearlyChange                    ws.Cells(summTableRow, 11).Value = percentChange                    ws.Cells(summTableRow, 11).NumberFormat = "0.00%"                                'Conditional color                    If yearlyChange < 0 Then                        ws.Cells(summTableRow, 10).Interior.ColorIndex = 3                    ElseIf yearlyChange > 0 Then                        ws.Cells(summTableRow, 10).Interior.ColorIndex = 4                    Else                        ws.Cells(summTableRow, 10).Interior.ColorIndex = 2                    End If                                        'increment summary table row                    summTableRow = summTableRow + 1                    'reset amount charge                    totalVolume = 0                    openPrice = ws.Cells(i + 1, 3).Value                End If                                Next i                                'Summary table with greatest and least decrease                    ws.Cells(2, 14).Value = "Largest Percent Change"                    ws.Cells(3, 14).Value = "Smallest Percent Change"                    ws.Cells(4, 14).Value = "Largest Stock Volume"                    row_max = 0                    summTableRow2 = 2                    max_change = 0                    min_change = 0                    row_totalVolume = 0                    totalVolume2 = 0                                                                'Greatest number                            max_change = WorksheetFunction.Max(Range("K:K"))                            ws.Cells(summTableRow2, 16).Value = max_change                            ws.Cells(summTableRow2, 16).NumberFormat = "0.00%"                            summTableRow2 = summTableRow2 + 1                                                                          'Match ticker                        row_max = WorksheetFunction.Match(max_change, Range("K:K"), 0)                        ws.Cells(2, 15).Value = ws.Cells(row_max, 9)                                            'Minimum number                            min_change = WorksheetFunction.Min(Range("K:K"))                            ws.Cells(summTableRow2, 16).Value = min_change                            ws.Cells(summTableRow2, 16).NumberFormat = "0.00%"                            summTableRow2 = summTableRow2 + 1                                        'match ticker for minimum                            row_min = WorksheetFunction.Match(min_change, Range("k:k"), 0)                            ws.Cells(3, 15).Value = ws.Cells(row_min, 9)                                               'Greatest Total Volume                        totalVolume2 = WorksheetFunction.Max(Range("L:L"))                        ws.Cells(summTableRow2, 16).Value = totalVolume2                                            'match ticker for total volume                        row_totalVolume = WorksheetFunction.Match(totalVolume2, Range("L:L"), 0)                        ws.Cells(4, 15).Value = ws.Cells(row_totalVolume, 9)                            Next ws    End Sub